{% extends 'base.html' %}
{% block content %}
  <div class="container dashboard-wrapper mt-5">
    <div class="dashboard-card shadow-lg p-4 bg-glass">
      <h2 class="text-white mb-3">⚓ Bienvenue à bord, <span class="text-warning">{{ user.username }}</span> !</h2>
      <p class="text-light mb-4">Voici ton tableau de bord capitaine.</p>

      <h4 class="text-white mb-3" id="avenir">🗓️ Séances à venir :</h4>
      <div class="table-responsive">
        <table class="table table-dark table-hover table-striped border rounded overflow-hidden">
          <thead class="table-light text-dark">
            <tr>
              <th>Date</th>
              <th>Heure</th>
              <th>Client</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for seance in seances_avenir %}
              <tr>
                <td onclick="window.location.href='{% url 'seance_detail' seance.id %}'" style="cursor: pointer;">{{ seance.date }}</td>
                <td onclick="window.location.href='{% url 'seance_detail' seance.id %}'" style="cursor: pointer;">{{ seance.heure_debut }}</td>
                <td onclick="window.location.href='{% url 'seance_detail' seance.id %}'" style="cursor: pointer;">{{ seance.client.username }}</td>
                <td>
                  {% if seance.statut != 'annule' %}
                    <a href="{% url 'annuler_seance' seance.id %}" class="btn btn-sm btn-danger">Annuler</a>
                  {% else %}
                    <span class="badge bg-secondary">Annulée</span>
                  {% endif %}
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4">Aucune séance à venir.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if seances_avenir.paginator.num_pages > 1 %}
        <div class="pagination text-white d-flex justify-content-between align-items-center">
          {% if seances_avenir.has_previous %}
            <a href="?page_avenir={{ seances_avenir.previous_page_number }}#avenir" class="btn btn-outline-light">← Précédent</a>
          {% endif %}
          <span>Page {{ seances_avenir.number }} / {{ seances_avenir.paginator.num_pages }}</span>
          {% if seances_avenir.has_next %}
            <a href="?page_avenir={{ seances_avenir.next_page_number }}#avenir" class="btn btn-outline-light">Suivant →</a>
          {% endif %}
        </div>
      {% endif %}

      <hr class="my-5" />

      <h4 class="text-white mb-3" id="passees">🏴‍☠️ Séances passées :</h4>
      <div class="table-responsive">
        <table class="table table-dark table-hover table-striped border rounded overflow-hidden">
          <thead class="table-light text-dark">
            <tr>
              <th>Date</th>
              <th>Heure</th>
              <th>Client</th>
              <th>Etat</th>
            </tr>
          </thead>
          <tbody>
            {% for seance in seances_passees %}
              <tr onclick="window.location.href='{% url 'seance_detail' seance.id %}'" style="cursor: pointer;">
                <td>{{ seance.date }}</td>
                <td>{{ seance.heure_debut }}</td>
                <td>{{ seance.client.username }}</td>
                <td>
                  {% if seance.statut != 'annule' %}
                    <span class="badge bg-secondary badge-success">Actif</span>
                  {% else %}
                    <span class="badge bg-secondary badge-danger">Annulée</span>
                  {% endif %}
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4">Aucune séance passée.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if seances_passees.paginator.num_pages > 1 %}
        <div class="pagination text-white d-flex justify-content-between align-items-center">
          {% if seances_passees.has_previous %}
            <a href="?page_passees={{ seances_passees.previous_page_number }}#passees" class="btn btn-outline-light">← Précédent</a>
          {% endif %}
          <span>Page {{ seances_passees.number }} / {{ seances_passees.paginator.num_pages }}</span>
          {% if seances_passees.has_next %}
            <a href="?page_passees={{ seances_passees.next_page_number }}#passees" class="btn btn-outline-light">Suivant →</a>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}
